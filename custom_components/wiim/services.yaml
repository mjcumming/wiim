play_preset:
  name: Play Preset
  description: >
    Play a specific preset (device dependent).

    WARNING: Due to WiiM firmware behavior, presets may automatically resume/override other sources
    (e.g., Spotify, AirPlay) after a few seconds. If you experience this issue, use the
    media_player.play_media service with the stream URL instead, or ensure you stop preset playback
    before switching to external sources. See: https://github.com/mjcumming/wiim/issues/68
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    preset:
      name: Preset Number
      description: Preset number to play (refer to device capability)
      required: true
      selector:
        number:
          min: 1
          max: 20

play_url:
  name: Play URL
  description: Play media from a URL
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    url:
      name: URL
      description: URL of the media to play
      required: true
      selector:
        text:

play_playlist:
  name: Play Playlist
  description: Play an M3U playlist
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    playlist_url:
      name: Playlist URL
      description: URL of the M3U playlist
      required: true
      selector:
        text:

set_eq:
  name: Set EQ
  description: Set equalizer preset or custom values
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    preset:
      name: EQ Preset
      description: EQ preset name
      required: true
      selector:
        select:
          options:
            - "flat"
            - "classical"
            - "jazz"
            - "vocal"
            - "pop"
            - "rock"
            - "dance"
            - "country"
            - "blues"
            - "custom"
    custom_values:
      name: Custom EQ Values
      description: Custom EQ values (required when preset is 'custom')
      required: false
      selector:
        object:

play_notification:
  name: Play Notification
  description: Play a notification sound
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    url:
      name: Notification URL
      description: URL of the notification sound
      required: true
      selector:
        text:

reboot_device:
  name: Reboot Device
  description: Reboot the WiiM device
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    entity_id:
      name: Entity ID
      description: The media player entity to reboot
      required: true
      selector:
        entity:
          domain: media_player
          integration: wiim

sync_time:
  name: Sync Time
  description: Synchronize device time with Home Assistant
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    entity_id:
      name: Entity ID
      description: The media player entity to sync time with
      required: true
      selector:
        entity:
          domain: media_player
          integration: wiim

# ===== UNOFFICIAL API SERVICES =====
# These services use reverse-engineered endpoints and may not work on all firmware versions

scan_bluetooth:
  name: Scan for Bluetooth Devices
  description: >
    Scan for nearby Bluetooth devices.

    WARNING: This uses unofficial API endpoints and may not be available on all firmware versions.
    The scan typically takes 3-10 seconds. Results are not returned by this service.
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    duration:
      name: Scan Duration
      description: How long to scan in seconds (3-10 recommended)
      required: false
      selector:
        number:
          min: 3
          max: 10
      default: 3

set_channel_balance:
  name: Set Channel Balance
  description: >
    Adjust left/right channel balance.

    WARNING: This uses unofficial API endpoints and may not be available on all firmware versions.
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    balance:
      name: Balance
      description: Balance from -1.0 (full left) to 1.0 (full right), 0.0 is center
      required: true
      selector:
        number:
          min: -1.0
          max: 1.0
          step: 0.1

set_spdif_delay:
  name: Set SPDIF Switch Delay
  description: >
    Set SPDIF sample rate switch latency in milliseconds.

    WARNING: This uses unofficial API endpoints and may not be available on all firmware versions.
    Only relevant when using SPDIF optical output.
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    delay_ms:
      name: Delay (ms)
      description: Switch delay in milliseconds (0-3000)
      required: true
      selector:
        number:
          min: 0
          max: 3000

discover_lms_servers:
  name: Discover LMS Servers
  description: >
    Search for Lyrion Music Server (Logitech Media Server) instances on the network.

    WARNING: This uses unofficial API endpoints and may not be available on all firmware versions.
    This triggers Squeezelite to search for LMS servers.
  target:
    entity:
      domain: media_player
      integration: wiim

connect_lms_server:
  name: Connect to LMS Server
  description: >
    Connect to a specific Lyrion Music Server instance.

    WARNING: This uses unofficial API endpoints and may not be available on all firmware versions.
    This configures Squeezelite to connect to the specified LMS server.
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    server_address:
      name: Server Address
      description: LMS server IP address (with optional port, e.g., "192.168.1.123:3483")
      required: true
      selector:
        text:

set_auto_connect_lms:
  name: Set LMS Auto-Connect
  description: >
    Enable or disable automatic connection to LMS servers.

    WARNING: This uses unofficial API endpoints and may not be available on all firmware versions.
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    enabled:
      name: Auto-Connect
      description: Whether to automatically connect to previously connected LMS servers
      required: true
      selector:
        boolean:

set_touch_buttons:
  name: Set Touch Button Controls
  description: >
    Enable or disable the physical touch buttons on the device.

    WARNING: This uses unofficial API endpoints and may not be available on all firmware versions.
    This controls the hardware buttons, not Home Assistant button entities.
  target:
    entity:
      domain: media_player
      integration: wiim
  fields:
    enabled:
      name: Enable Buttons
      description: Whether to enable the touch buttons on the device
      required: true
      selector:
        boolean:

set_sleep_timer:
  name: Set Sleep Timer
  description: Set a sleep timer on the WiiM device (WiiM devices only).
  target:
    entity:
      integration: wiim
      domain: media_player
  fields:
    sleep_time:
      name: Sleep Time
      description: Time in seconds until the device turns off (0-7200)
      required: true
      selector:
        number:
          min: 0
          max: 7200
          unit_of_measurement: seconds

clear_sleep_timer:
  name: Clear Sleep Timer
  description: Clear the sleep timer on the WiiM device (WiiM devices only).
  target:
    entity:
      integration: wiim
      domain: media_player

update_alarm:
  name: Update Alarm
  description: >
    Update an alarm on the WiiM device (WiiM devices only).

    WiiM devices support 3 alarm slots (0-2). Alarm times must be in UTC format.
  target:
    entity:
      integration: wiim
      domain: media_player
  fields:
    alarm_id:
      name: Alarm ID
      description: The alarm slot to update (0-2)
      required: true
      selector:
        number:
          min: 0
          max: 2
          mode: box
    time:
      name: Time
      description: Alarm time in UTC (HH:MM:SS format, e.g., "07:00:00")
      required: false
      selector:
        text:
    trigger:
      name: Trigger
      description: Alarm trigger type (e.g., "daily")
      required: false
      selector:
        text:
    operation:
      name: Operation
      description: Alarm operation type (e.g., "playback")
      required: false
      selector:
        text:
